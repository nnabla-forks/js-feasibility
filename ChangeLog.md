# Change Log

## 2025年7月15日

### ゲーム開始ボタンの追加

- `index.html`にゲーム開始ボタンを追加しました。
- `game.js`を修正し、ゲーム開始ボタンが押されるまでゲームが始まらないようにしました。

## 2025年7月14日

### 初期セットアップと基本機能の実装

- `canvas/prime-slicer` ディレクトリを作成し、ゲームの基本ファイル (`index.html`, `style.css`, `game.js`, `prime.js`) を作成しました。

### ボールの挙動調整

- ボールの初速が足りない問題を修正し、より高く飛ぶように調整しました。
- ミスの許容回数を3回から100回に変更しました。
- ボールの大きさを約5倍にし、スピードを半分に調整しました。
- ボールの出現頻度を5倍に増加させました。

### ボールが画面下に留まる問題のデバッグと修正

- ボールが画面下から上昇しない問題について、段階的なデバッグを行いました。
  - 重力を一時的にゼロに設定し、基本アニメーションの動作を確認しました。
  - ボール生成ロジック (`Circle` クラスと `spawnCircle` 関数) を復活させ、複数のボールがまっすぐ上昇することを確認しました。
  - 重力を復活させ、ボールが放物線を描いて落下することを確認しました。
  - 初速を再調整し、適切な放物線運動になるように修正しました。
- 画面下でのボールの消去判定ロジックを修正し、ボール全体が画面外に出てから消えるようにしました。

### UIの追加と機能拡張

- ボールの発生頻度と初速をリアルタイムで調整できるUI (`spawnRate` と `initialVelocity` スライダー) を `index.html` と `style.css` に追加しました。
- `game.js` を修正し、UIスライダーの値がゲームロジックに反映されるようにしました。
- ボールが切られた際に、その場でエフェクトが表示される機能を追加しました。エフェクト表示中は当たり判定が無効になります。
- ボールが切られた際のエフェクトが完全に終了してから、分裂処理（またはミス判定）が行われるように修正しました。

## 2026年1月3日

### Modulo Krinkle Tiling エディタの作成

- `tess/ModuloKrinkleTiling` ディレクトリに新しいプロジェクトを作成しました。
- 基本的なファイル構成 (`index.html`, `style.css`, `src/main.js`, `src/renderer.js`, `src/krinkle.js`) を実装しました。
- ダークモードとグラスモーフィズムを採用したモダンなUIを構築しました。
- 論文 (arXiv:2506.07638) に基づくタイリング生成ロジック (`krinkle.js`) を実装しました。`pdftotext` を使用して論文からアルゴリズムを抽出し、プロトタイル生成、フロント追跡、ウェッジ配置のロジックを組み込みました。
- **フェーズ1 (2026/01/03)**: ユーザーフィードバックに基づき、まずはプロトタイル作成のみを行う「Prototile Viewer」モードにリファクタリングしました。`krinkle.js` で単一のウェッジを生成し、`renderer.js` で自動センタリングする機能を追加しました。UIパラメータも論文の記号 ($m, k, n$) に合わせて整理しました。
    - **改善**: ローカル実行 (`file://`) のためにJSファイルを `app.js` に統合しました。
    - **改善**: パラメータ変更時に即座に再描画されるようにリアルタイム更新機能を追加しました。
    - **UI追加**: プロトタイルの始点（赤丸）と終点（青丸）、および各辺のインデックス番号を表示するようにしました。
    - **Logic修正**: ユーザー提供のPythonコードに基づき、`l_seq` と `u_seq` の生成ロジックを修正しました（`n != k` の場合でも図形が閉じるようになりました）。
    - **UI変更**: パラメータのラベルを論文の記号 (`m`, `k`, `n`) に変更し、「m (ステップ)」を一番上に移動しました。
    - **Logic変更**: パラメータ `n` を `t` (周期係数) に変更し、内部で $n = k \times t$ を計算するようにしました。ステータスバーに $(m, k, n)$ の計算結果を表示するように改善しました。
    - **UI変更**: リアルタイム更新が機能しているので「タイリング更新」ボタンを削除しました。
    - **機能追加**: Pythonスクリプトに存在した `Offset Mode` ($n = 2(tk - m)$) をUIから切り替えられるチェックボックスを追加しました。
    - **Logic修正 (User)**: `l_seq`, `u_seq` 生成時に `0` (modulo k) に達したらループを中断する処理を追加し、重複的な図形生成を防止しました。
    - **Refactor**: 変数名 `skipped` を、その意味（周期がkより短い）に基づき `hasShortPeriod` に変更しました。